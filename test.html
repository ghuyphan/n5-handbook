<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simplified Kanji Card Prototype (Modal)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #111827;
            color: #F3F4F6;
        }
        .noto-sans-jp { font-family: 'Noto Sans JP', sans-serif; }

        /* Card flip animation */
        .card { perspective: 1500px; }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
        }
        .card.is-flipped .card-inner { transform: rotateY(180deg); }
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 1rem;
            overflow: hidden;
        }
        .card-face-front {
            background: rgba(55, 65, 81, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.4);
        }
        .card-face-back {
            background: linear-gradient(135deg, #8B5CF6, #A78BFA);
            color: white;
            transform: rotateY(180deg);
            padding: 1rem;
            flex-direction: column;
            justify-content: space-between;
        }

        /* Modal styles */
        .modal-hidden { 
            display: none !important; 
            pointer-events: none !important;
        }
        .modal-show {
            pointer-events: auto;
        }
        .modal-backdrop {
            position: fixed;
            inset: 0;
            z-index: 40;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            animation: fadeIn 0.3s ease-out;
            pointer-events: auto;
        }
        .modal-content {
            animation: slideUp 0.4s ease-out;
            z-index: 50;
            pointer-events: auto;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl sm:text-3xl font-bold text-center mb-2">Kanji Card Prototype (Modal)</h1>
        <p class="text-center text-gray-400 mb-8">Click a card to flip. On the back, click "View Details".</p>

        <div id="kanji-grid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6">
            <!-- Cards will be inserted here -->
        </div>
    </div>

    <!-- Modal Structure -->
    <div id="kanji-modal" class="modal-hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <div id="modal-backdrop" class="modal-backdrop"></div>
        <div id="modal-content" class="modal-content relative w-full max-w-md bg-gray-800 rounded-2xl shadow-lg p-6 text-white">
            <!-- Content will be injected here -->
        </div>
    </div>

    <script>
        const mockKanjiData = [
            {
                id: 'k1',
                kanji: '学',
                meaning: { en: 'Study, learning', vi: 'Học, học tập' },
                onyomi: 'ガク',
                kunyomi: 'まな.ぶ',
                radical: '子 (child)',
                mnemonic: 'A child (子) under a roof (宀) is learning.',
                examples: [
                    { word: '学生', reading: 'がくせい', meaning: 'Student' },
                    { word: '学校', reading: 'がっこう', meaning: 'School' },
                    { word: '大学', reading: 'だいがく', meaning: 'University' },
                ],
                sentence: { jp: '私は学生です。', en: 'I am a student.' }
            },
            {
                id: 'k2',
                kanji: '日',
                meaning: { en: 'Day, sun', vi: 'Ngày, mặt trời' },
                onyomi: 'ニチ, ジツ',
                kunyomi: 'ひ, -び, -か',
                radical: '日 (sun)',
                mnemonic: 'A pictograph of the sun.',
                examples: [
                    { word: '今日', reading: 'きょう', meaning: 'Today' },
                    { word: '日本', reading: 'にほん', meaning: 'Japan' },
                    { word: '日曜日', reading: 'にちようび', meaning: 'Sunday' },
                ],
                sentence: { jp: '今日は日曜日です。', en: 'Today is Sunday.' }
            },
            {
                id: 'k3',
                kanji: '水',
                meaning: { en: 'Water', vi: 'Nước' },
                onyomi: 'スイ',
                kunyomi: 'みず',
                radical: '水 (water)',
                mnemonic: 'A pictograph of flowing water.',
                examples: [
                    { word: '水曜日', reading: 'すいようび', meaning: 'Wednesday' },
                    { word: '水を飲む', reading: 'みずをのむ', meaning: 'To drink water' },
                ],
                sentence: { jp: '水をください。', en: 'Water, please.' }
            },
             {
                id: 'k4',
                kanji: '人',
                meaning: { en: 'Person', vi: 'Người' },
                onyomi: 'ジン, ニン',
                kunyomi: 'ひと',
                radical: '人 (person)',
                mnemonic: 'A pictograph of a person walking.',
                examples: [
                    { word: '日本人', reading: 'にほんじん', meaning: 'Japanese person' },
                    { word: '一人', reading: 'ひとり', meaning: 'One person' },
                    { word: '三人', reading: 'さんにん', meaning: 'Three people' },
                ],
                sentence: { jp: 'あの人は誰ですか。', en: 'Who is that person?' }
            },
        ];

        const kanjiGrid = document.getElementById('kanji-grid');
        const modal = document.getElementById('kanji-modal');
        const modalContent = document.getElementById('modal-content');
        const modalBackdrop = document.getElementById('modal-backdrop');

        function createKanjiCard(item) {
            const cardContainer = document.createElement('div');
            cardContainer.className = 'card h-36 sm:h-48 cursor-pointer';
            cardContainer.innerHTML = `
                <div class="card-inner">
                    <!-- Front of the card -->
                    <div class="card-face card-face-front">
                        <p class="text-5xl sm:text-7xl font-bold noto-sans-jp">${item.kanji}</p>
                    </div>
                    <!-- SIMPLIFIED Back of the card -->
                    <div class="card-face card-face-back text-center">
                        <div class="w-full">
                            <p class="font-bold text-xl mb-2">${item.meaning.en}</p>
                            <div class="text-sm opacity-80">
                                <p>On: ${item.onyomi}</p>
                                <p>Kun: ${item.kunyomi}</p>
                            </div>
                        </div>
                        <button class="view-details-btn mt-4 w-full bg-white/20 hover:bg-white/30 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200 z-10 relative" data-id="${item.id}">
                            View Details
                        </button>
                    </div>
                </div>
            `;
            return cardContainer;
        }

        function populateModal(item) {
            modalContent.innerHTML = `
                <button id="close-modal-btn" class="absolute top-3 right-3 text-gray-400 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <div class="text-center mb-4">
                    <h1 class="text-6xl font-bold noto-sans-jp">${item.kanji}</h1>
                    <p class="text-xl text-gray-300">${item.meaning.en}</p>
                </div>
                <div class="space-y-4 text-sm">
                    <div>
                        <h3 class="font-semibold text-gray-400 border-b border-gray-600 pb-1 mb-2">Examples</h3>
                        <ul class="space-y-1">
                            ${item.examples.map(ex => `
                                <li class="flex justify-between items-baseline">
                                    <span class="font-semibold noto-sans-jp">${ex.word} <span class="text-xs text-gray-400 font-sans">${ex.reading}</span></span>
                                    <span class="text-xs text-gray-300">${ex.meaning}</span>
                                </li>
                            `).join('')}
                        </ul>
                        <div class="mt-2 pt-2 border-t border-gray-700 text-gray-300">
                            <p class="noto-sans-jp">${item.sentence.jp}</p>
                            <p class="text-xs opacity-80">${item.sentence.en}</p>
                        </div>
                    </div>
                     <div>
                        <h3 class="font-semibold text-gray-400 border-b border-gray-600 pb-1 mb-2">Info</h3>
                        <div class="space-y-2 text-xs text-gray-300">
                            <div><p class="font-semibold text-gray-400">Radical:</p><p>${item.radical}</p></div>
                            <div><p class="font-semibold text-gray-400">Mnemonic:</p><p>${item.mnemonic}</p></div>
                        </div>
                    </div>
                </div>
            `;
        }

        function openModal(itemId) {
            const item = mockKanjiData.find(k => k.id === itemId);
            if (item) {
                populateModal(item);
                modal.style.display = 'flex';
                modal.classList.remove('modal-hidden');
                modal.classList.add('modal-show');
            }
        }

        function closeModal() {
            modal.classList.add('modal-hidden');
            modal.classList.remove('modal-show');
            modal.style.display = 'none';
        }

        // Initialize the application
        function init() {
            // Ensure modal is hidden on initialization
            modal.classList.add('modal-hidden');
            modal.classList.remove('modal-show');
            modal.style.display = 'none';
            
            // Create cards first
            mockKanjiData.forEach(item => {
                const card = createKanjiCard(item);
                kanjiGrid.appendChild(card);
            });

            // Then attach event listeners using event delegation
            kanjiGrid.addEventListener('click', (e) => {
                const card = e.target.closest('.card');
                if (!card) return;

                const viewDetailsBtn = e.target.closest('.view-details-btn');
                if (viewDetailsBtn) {
                    // Stop propagation to prevent card flip
                    e.stopPropagation();
                    const itemId = viewDetailsBtn.dataset.id;
                    openModal(itemId);
                } else {
                    // Toggle card flip
                    card.classList.toggle('is-flipped');
                }
            });

            // Modal event listeners
            modal.addEventListener('click', (e) => {
                if (e.target.id === 'modal-backdrop' || e.target.closest('#close-modal-btn')) {
                    closeModal();
                }
            });

            // Keyboard support for closing modal
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !modal.classList.contains('modal-hidden')) {
                    closeModal();
                }
            });
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>